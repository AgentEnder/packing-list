import{j as e,z as M,A as D,E as H,n as U,m as V,B as z,D as $,l as W,f as Y,S as q,i as G,W as K,o as J,L as Q,a as X,b as Z,c as ee,d as te}from"../chunks/chunk-CkW1dBBz.js";import{u as S,a as _,t as ae,b as y,v as R,w as L,f as se,x as le,y as re,s as ne,z as ie,A,e as oe,g as de}from"../chunks/chunk-Bwb-TI-m.js";import{r as o,a as ce}from"../chunks/chunk-pSdIku02.js";import{P as E,a as k}from"../chunks/chunk-CIGAIrCQ.js";import{H as me}from"../chunks/chunk-pm1Kw1LK.js";import{N as ue}from"../chunks/chunk-CGX-a3s_.js";import{F as pe}from"../chunks/chunk-DhEZ9Pnn.js";/* empty css                      *//* empty css                      *//* empty css                      */const he=t=>!!t.userPersonId,xe=(t,i)=>!!(t.userPersonId&&i&&t.userPersonId===i.id&&i.isUserProfile),ge=["male","female","other"],fe={name:"",age:"",gender:"male"},be=({person:t,onCancel:i})=>{const d=S(),[l,v]=o.useState(()=>t?{name:t.name,age:String(t.age),gender:t.gender}:fe),n=s=>{v(h=>({...h,[s.target.name]:s.target.value}))},b=s=>{s.preventDefault(),!(!l.name||!l.age)&&(d(t?{type:"UPDATE_PERSON",payload:{id:t.id,name:l.name,age:Number(l.age),gender:l.gender}}:_.addPerson({name:l.name,age:Number(l.age),gender:l.gender})),i())};return e.jsx("div",{className:"card bg-base-100 shadow-xl border-2 border-primary min-h-[280px] flex flex-col",children:e.jsxs("form",{onSubmit:b,className:"card-body gap-2 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",htmlFor:"name",children:e.jsx("span",{className:"label-text",children:"Name"})}),e.jsx("input",{id:"name",className:"input input-bordered w-full mb-2",name:"name",value:l.name,onChange:n,placeholder:"Name",required:!0,"data-testid":"person-name-input"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",htmlFor:"age",children:e.jsx("span",{className:"label-text",children:"Age"})}),e.jsx("input",{id:"age",className:"input input-bordered w-full mb-2",name:"age",type:"number",min:"0",value:l.age,onChange:n,placeholder:"Age",required:!0,"data-testid":"person-age-input"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",htmlFor:"gender",children:e.jsx("span",{className:"label-text",children:"Gender"})}),e.jsx("select",{id:"gender",className:"select select-bordered w-full",name:"gender",value:l.gender,onChange:n,"data-testid":"person-gender-select",children:ge.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]})]}),e.jsxs("div",{className:"card-actions justify-end",children:[e.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"save-person-button",children:t?"Save":"Add Person"}),e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:i,"data-testid":"cancel-person-button",children:"Cancel"})]})]})})},je=({person:t,onDelete:i})=>{const[d,l]=o.useState(!1),[v,n]=o.useState(!1),{user:b}=ae(),s=S(),h=y(R),m=o.useRef(null),u=xe(t,h),N=he(t)&&!u,x=async()=>{if(!b||u)return;const g={id:se(),userId:b.id,name:t.name,birthDate:t.age?L(t.age):void 0,gender:t.gender,settings:{},isUserProfile:!1,autoAddToNewTrips:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,isDeleted:!1};s(le(g)),n(!1)},j=o.useCallback(g=>{n(!0),m.current&&document.removeEventListener("click",m.current);const w=()=>{n(!1),document.removeEventListener("click",w),m.current=null};return m.current=w,document.addEventListener("click",w),g.stopPropagation()},[]);return o.useEffect(()=>()=>{m.current&&document.removeEventListener("click",m.current)},[]),d?e.jsx(be,{person:t,onCancel:()=>l(!1)}):e.jsx("div",{className:"card bg-base-100 shadow-xl min-h-[280px] flex flex-col","data-testid":`person-card-${t.name.toLowerCase().replace(/\s+/g,"-")}`,children:e.jsxs("div",{className:"card-body gap-2 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"font-medium text-lg",children:t.name}),u&&e.jsxs("div",{className:"flex items-center gap-1 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium","data-testid":"profile-indicator",children:[e.jsx(M,{className:"h-3 w-3"}),"You"]}),N&&e.jsxs("div",{className:"flex items-center gap-1 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium","data-testid":"template-indicator",children:[e.jsx(D,{className:"h-3 w-3"}),"From Template"]})]}),e.jsxs("div",{className:"text-gray-500",children:["Age: ",t.age]}),e.jsxs("div",{className:"text-gray-500",children:["Gender: ",t.gender]})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:j,"data-testid":"person-menu-button",children:e.jsx(H,{className:"h-4 w-4"})}),v&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[150px]",children:[u?e.jsx("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 text-sm",onClick:()=>{U(ce("/packing-list","/profile"))},"data-testid":"view-profile-button",children:"Edit Profile"}):e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{l(!0)},"data-testid":"edit-person-button",children:[e.jsx(V,{className:"h-3 w-3"}),"Edit"]}),!u&&!N&&e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 text-sm flex items-center gap-2",onClick:x,"data-testid":"save-as-template-button",children:[e.jsx(z,{className:"h-3 w-3"}),"Save as Template"]}),!u&&e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-100 text-sm flex items-center gap-2 text-red-600",onClick:()=>{i(),n(!1)},"data-testid":"delete-person-button",children:[e.jsx($,{className:"h-3 w-3"}),"Delete"]})]})]})})]})})},ve=["male","female","other","prefer-not-to-say"],ye={name:"",age:"",gender:"male",saveAsTemplate:!1},Ne=({person:t,onCancel:i,showTemplateFeatures:d=!0})=>{const l=S(),v=y(R),n=y(re),b=y(ne),[s,h]=o.useState(()=>t?{name:t.name,age:String(t.age||""),gender:t.gender||"male",saveAsTemplate:!1}:ye),[m,u]=o.useState(null),[N,x]=o.useState(!1),[j,g]=o.useState(-1),w=o.useRef(null),F=o.useRef(null),p=ie(n,s.name,5),T=p.some(a=>a.name.toLowerCase()===s.name.toLowerCase());o.useEffect(()=>{g(-1)},[p]);const P=a=>{const{name:c,value:r}=a.target;c==="name"?(h(f=>({...f,name:r})),u(null),x(r.length>0&&!t&&d),g(-1)):h(f=>({...f,[c]:r}))},C=a=>{u(a);const c=b?.tripEvents?.find(f=>f.type==="leave_home")?.date,r=A(a.birthDate,c);h(f=>({...f,name:a.name,age:r?String(r):"",gender:a.gender||"male"})),x(!1)},I=a=>{h(c=>({...c,saveAsTemplate:a.target.checked}))},O=a=>{if(!N||p.length===0)return;const c=p.length+(T?-1:0);switch(a.key){case"ArrowDown":a.preventDefault(),g(r=>r<c?r+1:r===-1?0:r);break;case"ArrowUp":a.preventDefault(),g(r=>r>0?r-1:r);break;case"Enter":a.preventDefault(),j>=0&&j<p.length?C(p[j]):j===p.length&&!T&&x(!1);break;case"Escape":x(!1),g(-1);break}},B=a=>{if(a.preventDefault(),!s.name)return;const c={name:s.name,gender:s.gender,userPersonId:m?.id,age:s.age?Number(s.age):0};if(l(t?{type:"UPDATE_PERSON",payload:{id:t.id,...c}}:_.addPerson(c)),!t&&s.saveAsTemplate&&v){const r=s.age?L(Number(s.age)):"",f=new URLSearchParams({name:s.name,gender:s.gender,birthDate:r,source:"person-form"});U(`/people/manage?${f.toString()}`);return}i()};return e.jsx("div",{className:"card bg-base-100 shadow-xl border-2 border-primary min-h-[400px] flex flex-col",children:e.jsxs("form",{onSubmit:B,className:"card-body gap-2 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[!t&&d&&m&&e.jsxs("div",{className:"mb-4 flex items-center justify-between bg-blue-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm",children:["Using template: ",e.jsx("strong",{children:m.name})]})]}),e.jsx("button",{type:"button",onClick:()=>{u(null),h(a=>({...a,age:"",gender:"male"}))},className:"text-sm text-blue-600 hover:text-blue-800",children:"Clear"})]}),e.jsxs("div",{className:"form-control relative",children:[e.jsx("label",{className:"label",htmlFor:"name",children:e.jsx("span",{className:"label-text",children:"Name"})}),e.jsx("input",{ref:w,id:"name",className:"input input-bordered w-full mb-2",name:"name",value:s.name,autoComplete:"off",onChange:P,onKeyDown:O,onFocus:()=>x(s.name.length>0&&!t&&d),onBlur:()=>{setTimeout(()=>x(!1),150)},placeholder:"Name",required:!0,"data-testid":"person-name-input"}),N&&!t&&d&&(p.length>0||!T&&s.name.trim())&&e.jsxs("ul",{ref:F,className:"absolute z-50 w-full top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:[p.map((a,c)=>e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>C(a),className:`w-full px-3 py-2 text-left flex items-center gap-2 hover:bg-gray-100 ${c===j?"bg-blue-50 text-blue-700":"text-gray-700"}`,"data-testid":`template-suggestion-${a.name.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(D,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:a.name}),a.birthDate&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Born ",a.birthDate,b&&e.jsxs("span",{className:"ml-2",children:["• Age:"," ",A(a.birthDate,b.tripEvents?.find(r=>r.type==="leave_home")?.date)||A(a.birthDate)]})]}),a.gender&&e.jsx("div",{className:"text-sm text-gray-500",children:a.gender})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${a.isUserProfile?"text-green-600 bg-green-100":"text-blue-600 bg-blue-100"}`,children:a.isUserProfile?"You":"Template"})]})},a.id)),!T&&s.name.trim()&&e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>x(!1),className:`w-full px-3 py-2 text-left flex items-center gap-2 hover:bg-gray-100 border-t border-gray-200 ${j===p.length?"bg-green-50 text-green-700":"text-gray-700"}`,children:[e.jsx(W,{className:"w-4 h-4 text-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium",children:["Create “",s.name.trim(),"”"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Add as new person"})]})]})})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",htmlFor:"age"}),e.jsx("input",{id:"age",className:"input input-bordered w-full mb-2",name:"age",type:"number",min:"0",max:"150",value:s.age,onChange:P,placeholder:"Age","data-testid":"person-age-input",readOnly:!!m})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",htmlFor:"gender",children:e.jsx("span",{className:"label-text",children:"Gender (optional)"})}),e.jsx("select",{id:"gender",className:"select select-bordered w-full",name:"gender",value:s.gender,onChange:P,"data-testid":"person-gender-select",children:ve.map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1).replace("-"," ")},a))})]}),!t&&d&&!m&&e.jsxs("div",{className:"form-control",children:[e.jsxs("label",{className:"label cursor-pointer justify-start gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:s.saveAsTemplate,onChange:I,"data-testid":"save-as-template-checkbox"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"label-text",children:"Save as template for future trips"})]})]}),e.jsx("div",{className:"text-xs text-gray-500 ml-6 mt-1",children:"Creates a reusable template. Age will be converted to birth date."})]})]}),e.jsxs("div",{className:"card-actions justify-end gap-2 pt-4 border-t border-base-300",children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:i,"data-testid":"cancel-person-button",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!s.name.trim(),"data-testid":"save-person-button",children:t?"Save Changes":s.saveAsTemplate?"Add & Create Template":"Add Person"})]})]})})},we=({people:t})=>{const i=S(),[d,l]=o.useState(!1),v=n=>{i({type:"REMOVE_PERSON",payload:{id:n}})};return e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:[t.length===0&&!d&&e.jsx("div",{className:"text-gray-500 col-span-full",children:"No people added yet."}),t.map(n=>e.jsx(je,{person:n,onDelete:()=>v(n.id)},n.id)),d?e.jsx(Ne,{onCancel:()=>l(!1)}):e.jsxs("button",{className:"card bg-base-200 shadow-xl flex flex-col items-center justify-center border-2 border-dashed border-primary cursor-pointer min-h-[280px] hover:bg-primary hover:text-white transition col-span-1",onClick:()=>l(!0),type:"button","aria-label":"Add person","data-testid":"add-person-button",children:[e.jsx("span",{className:"text-5xl mb-2",children:"+"}),e.jsx("span",{className:"font-semibold",children:"Add Person"})]})]})};function Te(){const t=y(oe),i=y(de);return t?e.jsxs(E,{children:[e.jsx(k,{title:"People on this Trip",actions:e.jsxs(Y,{href:"/people/manage",className:"btn btn-outline btn-sm ml-auto",title:"Manage Templates",children:[e.jsx(q,{className:"w-4 h-4"}),"Manage Templates"]})}),e.jsxs(me,{storageKey:"travelers",title:"Managing Travelers",children:[e.jsx("p",{children:"Add everyone who's going on the trip to help calculate the right amount of items to pack. Each person's details help customize packing recommendations:"}),e.jsx("h3",{className:"text-base mt-4 mb-2",children:"Person Details"}),e.jsxs("dl",{className:"grid grid-cols-[auto_1fr] gap-x-3 gap-y-2 my-4",children:[e.jsx("dt",{className:"font-bold",children:"Name:"}),e.jsx("dd",{children:"Identify each traveler uniquely"}),e.jsx("dt",{className:"font-bold",children:"Age:"}),e.jsx("dd",{children:"Used for age-specific packing rules (e.g., baby items)"}),e.jsx("dt",{className:"font-bold",children:"Gender:"}),e.jsx("dd",{children:"Helps with gender-specific packing rules"})]}),e.jsxs("div",{className:"bg-base-200 rounded-lg p-4 my-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"How It Works"}),e.jsxs("p",{className:"text-sm text-base-content/70 m-0",children:["Your packing list will automatically adjust based on who's traveling:",e.jsx("br",{}),"• Items can be multiplied per person",e.jsx("br",{}),"• Special items can be added based on age or gender",e.jsx("br",{}),"• You can create custom rules for specific travelers"]})]})]}),e.jsx(we,{people:i}),e.jsx(pe,{})]}):e.jsxs(E,{children:[e.jsx(k,{title:"People on this Trip"}),e.jsx(ue,{title:"No Trip Selected",message:"You need to select a trip before you can manage travelers. Each trip can have different people with personalized packing recommendations.",actionText:"View My Trips",actionHref:"/trips"})]})}const Se=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"})),Pe="People - Packing List",Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"})),Ie={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:te}},onHydrationEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onHydrationEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ee}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Z}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:X}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/people/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Se}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:Q}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/people/+title.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Ae}},onBeforeRenderClient:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-redux/__internal/onBeforeRenderClient",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:J}]},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-redux/__internal/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:K}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:G}}};export{Ie as configValuesSerialized};
